# RChASM

RChASM: A Statistically Rigorous Method for the Detection of Chromosomal
Aneuploidies in Ancient DNA Studies.

RChASM is an R implementation of ChASM (Chromosomal Aneuploidy Screening
Methodology): a statistically rigorous Bayesian approach for screening
data sets for automsomal and sex chromosomal aneuploidies. RChASM takes
as input the number of (deduplicated) reads mapping to chromosomes 1-22
and the X and Y chromosomes, and models these using a
Dirichlet-multinomial distribution. From this, RChASM returns posterior
probabilities of sex chromosomal karyotypes (XX, XY, XXY, XYY, XXX and
X) and full automsomal aneuploidies (trisomy 13, tirsomy 18 and trisomy
21). RChASM also returns two diagnostic statistics: (i) a posterior
probability addressing whether contamination between XX and XY may
explain the observed sex chromosomal aneuploidy, and (ii) a chi-sqaured
statistic measuring whether the observed read counts are too divergent
from the underlying distribution (and may represent abnormal
sequencing/quality issues).

## Installation

You can install the development version of RChASM from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("jonotuke/RChASM")
```

## Example

Please see
[`vignette("example_analysis")`](https://jonotuke.github.io/RChASM/articles/example_analysis.md)
for a tutorial

# Package index

## All functions

- [`adjustA()`](https://jonotuke.github.io/RChASM/reference/adjustA.md)
  : Adjusts alpha vector for contamination karyotypes
- [`bound()`](https://jonotuke.github.io/RChASM/reference/bound.md) :
  bounds number to be in \[0,1\] (contamination estimation)
- [`callKaryotypes()`](https://jonotuke.github.io/RChASM/reference/callKaryotypes.md)
  : Take prior and observed counts and calls karyotypes and Z-scores
- [`ddirichletultinomial()`](https://jonotuke.github.io/RChASM/reference/ddirichletultinomial.md)
  : calculate Dirichlet probabilities with filtering
- [`dirichlet.mle_filter()`](https://jonotuke.github.io/RChASM/reference/dirichlet.mle_filter.md)
  : calculate Dirichlet parameters with filtering
- [`estimateGamma()`](https://jonotuke.github.io/RChASM/reference/estimateGamma.md)
  : Estimate contamination from XX and XY based on observed counts
- [`example_data`](https://jonotuke.github.io/RChASM/reference/example_data.md)
  : example_data
- [`filterOutliers()`](https://jonotuke.github.io/RChASM/reference/filterOutliers.md)
  : filter for outliers
- [`makeC()`](https://jonotuke.github.io/RChASM/reference/makeC.md) :
  make c vector for new karyotypes
- [`makeDirichlet()`](https://jonotuke.github.io/RChASM/reference/makeDirichlet.md)
  : function to make a Dirichlet prior
- [`makeZscores()`](https://jonotuke.github.io/RChASM/reference/makeZscores.md)
  : Calculates Z-scores per chromosome
- [`plot_diagnostic()`](https://jonotuke.github.io/RChASM/reference/plot_diagnostic.md)
  : Plots diagnostic plots
- [`processReadCounts()`](https://jonotuke.github.io/RChASM/reference/processReadCounts.md)
  : processReadCounts

# Articles

### All vignettes

- [Example ChASM Analysis Using Example
  Data](https://jonotuke.github.io/RChASM/articles/example_analysis.md):
